"""Web controllers â€” serves HTML pages."""

from pathlib import Path

from starlette.requests import Request
from starlette.templating import Jinja2Templates

from pyfly.container import controller
from pyfly.web import get_mapping, request_mapping

from {{ package_name }}.services.page_service import PageService

_templates = Jinja2Templates(directory=str(Path(__file__).parent.parent / "templates"))


@controller
@request_mapping("")
class HomeController:

    def __init__(self, page_service: PageService) -> None:
        self._page_service = page_service

    @get_mapping("/")
    async def home(self, request: Request):
        context = self._page_service.get_home_context()
        return _templates.TemplateResponse(request, "home.html", {**context, "request": request})

    @get_mapping("/about")
    async def about(self, request: Request):
        context = self._page_service.get_about_context()
        return _templates.TemplateResponse(request, "about.html", {**context, "request": request})
